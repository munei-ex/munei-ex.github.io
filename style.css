/* ==================================================
   0. 変数定義 (Variables)
   ================================================== */
:root {
  /* Colors */
  --color-primary: #007bff;
  --color-success: #28a745;
  --color-warning: #ffc107;
  --color-danger: #dc3545;
  --color-info: #17a2b8;
  --color-secondary: #6c757d;
  --color-special: #6f42c1;
  
  /* Light Mode Palette */
  --color-text: #333;
  --color-background: #f4f4f9;
  --color-surface: #ffffff;
  --color-border: #ddd;

  /* Sizing & Effects */
  --border-radius-sm: 5px;
  --border-radius-md: 8px;
  --border-radius-lg: 12px;
  --shadow-sm: 0 2px 5px rgba(0,0,0,0.1);
  --shadow-md: 0 4px 8px rgba(0,0,0,0.1);
}

body.dark-mode {
  /* Dark Mode Palette */
  --color-text: #f1f1f1;
  --color-background: #1a1a1a;
  --color-surface: #2c2c2c;
  --color-border: #444;
}


/* ==================================================
   1. 基本スタイル (General Styles)
   ================================================== */
body {
  font-family: sans-serif;
  background-color: var(--color-background);
  color: var(--color-text);
  padding-bottom: 100px;
  min-height: 100vh;
  margin: 0;
  box-sizing: border-box;
}

h1 {
  color: var(--color-text);
  text-align: center;
}

/* 非表示にするためのクラス */
.hidden {
  display: none !important;
}


/* ==================================================
   2. レイアウトコンテナ (Layout Containers)
   ================================================== */
.controls,
#gallery-view {
  width: 90%;
  max-width: 800px;
  margin: 0 auto 20px auto; /* 上下左右の余白と中央揃えをまとめて指定 */
  text-align: center;
}

#flashcard-view {
  width: 100%;
  display: flex;
  flex-direction: column;
  align-items: center;
}


/* ==================================================
   3. コンポーネント (Components)
   ================================================== */

/* --- コントロールパネル --- */
.controls {
  display: flex;
  flex-wrap: wrap;
  gap: 15px;
  justify-content: center;
  align-items: center;
  padding: 10px;
  background-color: var(--color-surface);
  border-radius: var(--border-radius-md);
  box-shadow: var(--shadow-sm);
}

select {
  padding: 8px 12px;
  border: 1px solid var(--color-border);
  border-radius: var(--border-radius-sm);
  font-size: 14px;
  cursor: pointer;
  background-color: var(--color-surface);
  color: var(--color-text);
}

.mode-group {
  display: flex;
  flex-wrap: wrap;
  gap: 10px;
  justify-content: center;
}

/* --- ボタン --- */
button {
  padding: 8px 12px;
  border-radius: var(--border-radius-sm);
  font-size: 14px;
  cursor: pointer;
  color: white;
  border: none;
}

.mode-group button { background-color: var(--color-secondary); }
#review-due-btn { background-color: var(--color-success); }
#reset-btn { background-color: var(--color-danger); }
#shuffle-btn { background-color: var(--color-info); }
#image-only-btn { background-color: var(--color-warning); }
#gallery-btn { background-color: var(--color-special); }
#gallery-view button { background-color: var(--color-primary); }

.action-buttons {
  margin-top: 20px;
  display: flex;
  align-items: center;
  justify-content: space-between;
  width: 100%;
  max-width: 400px;
  box-sizing: border-box;
  padding: 0 10px;
}
.nav-group { display: flex; gap: 10px; align-items: center; }
.action-buttons button { min-width: 0; padding: 10px 15px; font-weight: bold; }
#mark-review-btn { background-color: var(--color-warning); }
#mark-learned-btn { background-color: var(--color-success); }
#prev-btn, #next-btn { background-color: var(--color-primary); }
#undo-btn { background-color: var(--color-secondary); min-width: auto; }

/* --- 単語帳カード --- */
.card-container {
  perspective: 1500px;
  width: 90%;
  max-width: 400px;
  height: 200px;
}

.card {
  width: 100%; height: 100%; position: relative;
  transform-style: preserve-3d;
  transition: transform 0.7s;
}
.card.is-flipped { transform: rotateY(180deg); }

.card-face {
  position: absolute; width: 100%; height: 100%;
  backface-visibility: hidden;
  border-radius: var(--border-radius-lg);
  display: flex;
  box-sizing: border-box;
  text-align: center;
  box-shadow: var(--shadow-md);
  background-color: var(--color-surface);
  border: 1px solid var(--color-border);
}

.card-front {
  justify-content: center;
  align-items: center;
  padding: 20px;
  font-size: 18px;
}

.card-back {
  transform: rotateY(180deg);
  flex-direction: column;
}

#card-image {
  max-width: 100%; /* 画像タブに合わせるため少し変更 */
  max-height: 80px; /* 画像タブに合わせるため少し変更 */
  object-fit: contain;
  margin-top: 5px;
}

/* UPDATED: カード裏面の情報表示エリア */
#card-info-grid {
  width: 100%;
  flex: 1;
  overflow-y: auto;
  padding: 10px;
}

/* Default layout for multiple items (grid) */
#card-info-grid.multi-item {
  display: grid;
  grid-template-columns: auto 1fr; /* Label and Content columns */
  gap: 8px 10px;
  text-align: left;
  font-size: 14px;
}

/* Special layout for a single item (flex) */
#card-info-grid.single-item {
  display: flex;
  justify-content: center; /* Center horizontally */
  align-items: center;    /* Center vertically */
  text-align: center;
  font-size: 18px; /* Make the text larger */
}

#card-info-grid dt { /* Label */
  font-weight: bold;
  opacity: 0.8;
  grid-column: 1 / 2;
}

#card-info-grid dd { /* Content */
  margin: 0;
  grid-column: 2 / 3;
  white-space: pre-wrap;
}

#card-info-grid dt { /* This is the label (e.g., "機序") */
  font-weight: bold;
  opacity: 0.8;
  grid-column: 1 / 2;
}

#card-info-grid dd { /* This is the content */
  margin: 0;
  grid-column: 2 / 3;
  white-space: pre-wrap; /* Preserve line breaks from CSV */
}

/* --- ギャラリー --- */
#gallery-grid {
  display: grid;
  grid-template-columns: repeat(auto-fill, minmax(150px, 1fr));
  gap: 15px;
}
.gallery-item {
  border: 1px solid var(--color-border);
  border-radius: var(--border-radius-md);
  padding: 10px;
  background-color: var(--color-surface);
  box-shadow: var(--shadow-sm);
}
.gallery-item img { width: 100%; height: 120px; object-fit: contain; margin-bottom: 8px; }
.gallery-item p { margin: 0; font-size: 14px; font-weight: bold; color: var(--color-text); }


/* --- その他 (メモ、プラスαなど) --- */
.progress { margin-top: 15px; color: var(--color-text); font-size: 14px; }

.memo-container, #plus-alfa-container {
  margin-top: 20px;
  width: 90%;
  max-width: 400px;
  padding: 15px;
  border-radius: var(--border-radius-md);
  text-align: left;
}
.memo-container h2, #plus-alfa-container h3 { margin: 0 0 10px 0; font-size: 16px; }
.memo-container p, #plus-alfa-container p { margin: 0; font-size: 14px; line-height: 1.6; white-space: pre-wrap; }

#memo-textarea {
  width: 100%; height: 100px; padding: 10px;
  border: 1px solid var(--color-border);
  border-radius: var(--border-radius-md);
  font-size: 14px; font-family: sans-serif; resize: vertical;
  background-color: var(--color-surface);
  color: var(--color-text);
}
#memo-status { margin-top: 5px; font-size: 12px; color: var(--color-primary); height: 15px; text-align: right; }

#plus-alfa-container { background-color: #fffbe6; border: 1px solid #ffe58f; }
#plus-alfa-container h3 { color: #c47d00; }
body.dark-mode #plus-alfa-container { background-color: #3d341a; border-color: #7c6837; }
body.dark-mode #plus-alfa-container h3 { color: #fce18d; }

/* ダークモードスイッチ */
.theme-switch-wrapper { display: flex; align-items: center; gap: 8px; }
.theme-label { font-size: 14px; }
.theme-switch { position: relative; display: inline-block; width: 44px; height: 24px; }
.theme-switch input { opacity: 0; width: 0; height: 0; }
.slider { position: absolute; cursor: pointer; top: 0; left: 0; right: 0; bottom: 0; background-color: #ccc; transition: .4s; }
.slider:before { position: absolute; content: ""; height: 18px; width: 18px; left: 3px; bottom: 3px; background-color: white; transition: .4s; }
input:checked + .slider { background-color: var(--color-primary); }
input:checked + .slider:before { transform: translateX(20px); }
.slider.round { border-radius: 24px; }
.slider.round:before { border-radius: 50%; }
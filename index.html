<!DOCTYPE html>
<html lang="ja">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>薬理 暗記カード 🧠 - 国試対策版</title>
    <link rel="stylesheet" href="style.css">
</head>
<body>
    <div class="app-container">
        <header class="header">
            <div style="display:flex; align-items:center; justify-content:space-between;">
                <div>
                    <h1 style="margin-bottom:0;">薬理 暗記カード 🧠</h1>
                    <p class="subtitle" style="margin-top:2px;">AI搭載 高効率学習システム</p>
                </div>
                <button id="addDrugBtn" class="btn btn-success" style="font-size:0.98em; padding:7px 16px; margin-left:10px;">薬剤追加</button>
                <button id="howToBtn" class="btn btn-primary" style="font-size:0.98em; padding:7px 16px; margin-left:10px;">使い方</button>
    <!-- 薬剤追加モーダル -->
    <div id="addDrugModal" class="howto-modal" style="display:none;">
        <div class="howto-modal-content">
            <span id="addDrugClose" class="howto-close">&times;</span>
            <h2>薬剤を追加</h2>
            <form id="addDrugForm" autocomplete="off">
                <div style="margin-bottom:10px;">
                    <label>薬剤名 <input type="text" id="addDrugName" required style="width:70%;padding:4px;"></label>
                </div>
                <div style="margin-bottom:10px;">
                    <label>分野 <input type="text" id="addDrugCategory" placeholder="例: 抗菌薬" style="width:70%;padding:4px;"></label>
                </div>
                <div style="margin-bottom:10px;">
                    <label>重要度
                        <select id="addDrugImportance" style="padding:4px;">
                            <option value="high">高</option>
                            <option value="medium" selected>中</option>
                            <option value="low">低</option>
                        </select>
                    </label>
                </div>
                <div style="margin-bottom:10px;">
                    <label>メカニズム/説明 <input type="text" id="addDrugMechanism" style="width:70%;padding:4px;"></label>
                </div>
                <button type="submit" class="btn btn-success" style="width:100%;margin-top:8px;">追加</button>
            </form>
        </div>
    </div>
            </div>
    <!-- 使い方・モード説明モーダル -->
    <div id="howToModal" class="howto-modal" style="display:none;">
        <div class="howto-modal-content">
            <span id="howToClose" class="howto-close">&times;</span>
            <h2>このサイトの使い方</h2>
            <ul style="margin-bottom:1.2em;">
                <li>カード表面をタップ：裏面（答え）を表示</li>
                <li>裏面をタップ：表面に戻す</li>
                <li>左右スワイプ：覚えた/もう一度</li>
                <li>苦手分野・進捗は下部グラフで可視化</li>
            </ul>
            <h3>モードの使い分け</h3>
            <ul>
                <li><b>混合</b>：全カードからバランスよく出題</li>
                <li><b>弱点</b>：苦手分野・正答率の低いカードを優先</li>
                <li><b>重要</b>：重要度「高」のカードを優先</li>
                <li><b>復習</b>：復習タイミングが来たカードのみ出題</li>
            </ul>
            <p style="margin-top:1.2em; color:#aaa; font-size:0.98em;">いつでも右上「使い方」ボタンから再確認できます。</p>
        </div>
    </div>
            <div class="filter-container">
                <input type="search" id="searchInput" class="search-input" placeholder="薬剤名で検索...">
                <select id="categoryFilter" class="category-filter">
                    <option value="">すべての分野</option>
                </select>
            </div>
        </header>

    <div class="stats-panel">
            <div class="stat-item">
                <div class="stat-number" id="totalStudied">0</div>
                <div class="stat-label">今日の学習</div>
            </div>
            <div class="stat-item">
                <div class="stat-number" id="accuracy">0%</div>
                <div class="stat-label">覚えた率</div>
            </div>
            <div class="stat-item">
                <div class="stat-number" id="streak">0</div>
                <div class="stat-label">連続日数</div>
            </div>
            <div class="stat-item">
                <div class="stat-number" id="level">1</div>
                <div class="stat-label">レベル</div>
            </div>
        </div>
        <!-- 進捗グラフエリア -->
        <div class="progress-visual-panel" id="progressVisualPanel" style="margin: 10px 0; padding: 12px 12px 8px 12px;">
            <strong>全体進捗</strong>
            <div style="margin: 6px 0 10px 0;">
                <div class="modern-progress-bg">
                    <div id="overallProgressBar" class="modern-progress-bar"></div>
                    <span id="overallProgressLabel" class="modern-progress-label"></span>
                </div>
            </div>
        </div>
        <!-- 苦手分野表示エリア -->
        <div class="weak-categories-panel" id="weakCategoriesPanel">
            <strong>苦手分野TOP3</strong>
            <div id="weakCategoriesGraph"></div>
        </div>

        <div class="control-panel">
            <div class="mode-tabs">
                <button class="mode-tab active" data-mode="mixed">混合</button>
                <button class="mode-tab" data-mode="weak">弱点</button>
                <button class="mode-tab" data-mode="important">重要</button>
                <button class="mode-tab" data-mode="quick">復習</button>
            </div>
            <div class="settings-row">
                <span>マイクロラーニング</span>
                <div class="toggle-switch active" id="microToggle"></div>
            </div>
            <div class="settings-row">
                <span>音声読み上げ</span>
                <div class="toggle-switch" id="voiceToggle"></div>
            </div>
            <div class="settings-row">
                <span>自動進行</span>
                <div class="toggle-switch" id="autoToggle"></div>
            </div>
        </div>

        <div class="timer-section">
            <div class="timer" id="timer">残り時間: 10:00</div>
            <div class="progress-container">
                <div class="progress-bar" id="progressBar" style="width: 0%"></div>
            </div>
        </div>

        <div class="card-container" id="cardContainer">
            <div class="card-content">
                <div class="importance-badge badge-high" id="importanceBadge"></div>
                <div class="card-header-info">
                    <div class="drug-name" id="drugName">データを読込中...</div>
                    <div class="category-tag" id="categoryTag"></div>
                </div>
                <div class="drug-details" id="drugDetails"></div>
                <div id="plusAlfaSection" class="plus-alfa-section" style="display: none;">
                    <h4>💡 ワンポイント</h4>
                    <div id="plusAlfaContent" class="plus-alfa-content"></div>
                </div>
                <div id="memoSection" class="memo-section" style="display: none;">
                    <h4>📝 自分用メモ</h4>
                    <textarea id="memoTextarea" class="memo-textarea" placeholder="この薬に関するメモを自由に入力..."></textarea>
                </div>
            </div>
        </div>
        <!-- ボタンをカード直下に移動 -->
        <div class="button-container">
            <div class="button-group" id="initialButtons">
                <button class="btn btn-primary" id="showAnswerBtn">答えを見る</button>
            </div>
            <div class="button-group" id="answerButtons" style="display: none;">
                </div>
        </div>
        <!-- スワイプガイド -->
        <div class="swipe-guide">
            <span class="swipe-arrow swipe-left">←</span>
            <span>苦手・もう一度</span>
            <span class="swipe-separator">|</span>
            <span>覚えた！</span>
            <span class="swipe-arrow swipe-right">→</span>
        </div>
    </div>

    <div class="feedback-container" id="feedbackContainer">
        <div class="feedback-icon" id="feedbackIcon">🎉</div>
        <div class="feedback-message" id="feedbackMessage">よくできました！</div>
    </div>

    <script src="app.js"></script>
</body>
</html>